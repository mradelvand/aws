
---
title: "Architectural Deep Dive: Application Load Balancer (ALB)"
date: 2025-12-18
categories: [AWS Architecture]
tags: [ELB, ALB, Microservices, High Availability, Scalability, Networking]
---

# Architectural Deep Dive: Application Load Balancer (ALB)

## What is an Application Load Balancer?

The **Application Load Balancer (ALB)** operates at **Layer 7** of the OSI model. This means it understands application-level traffic, specifically **HTTP and HTTPS**. Unlike its predecessor (the Classic Load Balancer), the ALB is designed for **high-performance, containerized, and modular applications**.

### Key Technical Features

* **Protocol Support:** Full support for **HTTP/1.1**, **HTTP/2**, and **WebSockets**
* **Sticky Sessions:** Ability to bind a user's session to a specific instance using cookies
* **Native Redirects:** Configure automatic HTTP → HTTPS redirection at the listener level, reducing application complexity
* **Fixed Hostname:** Every ALB provides a stable DNS name  
  (e.g., `my-alb-12345.us-east-1.elb.amazonaws.com`)

> **Note:** Unlike the Network Load Balancer (NLB), you **cannot** assign a Static IP or Elastic IP directly to an ALB.

---

## Intelligent Routing: The Power of Rules

The biggest advantage of the ALB is its ability to route traffic to different **Target Groups** based on the **content of the request**.

### 1. Path-Based Routing

Traffic can be routed based on the URL path:

* `example.com/users` → Target Group A (User Microservice)
* `example.com/posts` → Target Group B (Post Microservice)

This is a core pattern for **microservices architectures**.

---

### 2. Host-Based Routing

Multiple domains can share the same ALB:

* `app.example.com` → Target Group C
* `api.example.com` → Target Group D

This approach reduces cost and centralizes TLS certificate management.

---

### 3. Query String & Header Routing

Routing decisions can also be made using query strings or custom HTTP headers:

* `example.com/search?platform=mobile`  
  → Routed to a mobile-optimized backend fleet

> **Technical Clarification:**  
> The ALB performs **connection termination**. It terminates the client TCP connection and opens a *new* connection to the backend targets. As a result, backend instances see the **ALB’s private IP**, not the client’s IP address.

---

## Target Groups: Where Traffic Lands

A **Target Group** defines where the ALB sends traffic.  
All **health checks** are configured at the **Target Group level**, not at the load balancer itself.

### Supported Target Types

* **EC2 Instances**  
  - Standalone instances or managed via an **Auto Scaling Group (ASG)**
* **ECS Tasks**  
  - Ideal for Docker containers  
  - Supports **Dynamic Port Mapping**, allowing multiple containers on the same host using different ports
* **Lambda Functions**  
  - Enables serverless HTTP backends behind an ALB
* **IP Addresses**  
  - Must be **private IPs**  
  - Can represent VPC resources or **on-premises servers** connected via VPN or Direct Connect

---

## Pro-Architect Use Cases

### Case 1: Microservices Consolidation

* **Problem:** A company runs 10 microservices. Using Classic Load Balancers would require 10 separate LBs, increasing cost and operational complexity.
* **Solution:** Use a **single ALB with Path-Based Routing** to serve all services.

**Benefits:**
- Lower cost
- Centralized TLS via AWS Certificate Manager (ACM)
- Simplified observability and access logging

---

### Case 2: Blue/Green & Canary Deployments

* **Problem:** You want to test a new application version without impacting all users.
* **Solution:** Use **Weighted Target Groups** (e.g., 90% to v1, 10% to v2).

This enables:
- Canary testing
- Zero-downtime deployments
- Instant rollback if issues are detected

---

### Case 3: Hybrid Cloud Migration

* **Problem:** You are migrating from an on-premises data center to AWS and need a single public entry point.
* **Solution:** Create a Target Group using the **private IP addresses** of on-prem servers.

> **Production Note:**  
> This pattern is excellent for **migration phases**, but it is **not ideal as a permanent production architecture** due to latency, operational complexity, and shared failure domains.

---

## Monitoring Client Information: X-Forwarded Headers

Because the ALB uses its own private IP to communicate with backend targets, applications must rely on injected headers to identify the original client:

* **`X-Forwarded-For`** – Original public IP of the client
* **`X-Forwarded-Port`** – Client source port (typically 80 or 443)
* **`X-Forwarded-Proto`** – Protocol used by the client (HTTP or HTTPS)

Applications should explicitly log and trust these headers when operating behind an ALB.

---

## SAA-C03 Knowledge Check

**1. A DevOps Engineer needs to route traffic based on the URL paths `/blog` and `/store`. Which AWS service is most appropriate?**

* A) Network Load Balancer  
* B) Classic Load Balancer  
* C) Application Load Balancer  
* D) Route 53 CNAME records  

**2. Which header contains the original client IP behind an ALB?**

* A) X-Source-IP  
* B) X-Forwarded-For  
* C) X-Real-IP  
* D) X-Forwarded-Proto  

**3. Which ALB feature enables routing to multiple ECS containers on the same EC2 host?**

* A) Sticky Sessions  
* B) Static IP Mapping  
* C) Dynamic Port Mapping  
* D) Host-based Routing  

**4. Can an Application Load Balancer have a static Elastic IP address?**

* A) Yes, by assigning it in the console  
* B) No, it only provides a DNS name  
* C) Yes, but only in a single Availability Zone  
* D) No, only Classic Load Balancers support static IPs  

**5. Where are health checks configured for ALB targets?**

* A) On the Lambda function itself  
* B) On the ALB Listener  
* C) Within the Target Group  
* D) Lambda functions do not require health checks  

---

### Answer Key

1: **C** | 2: **B** | 3: **C** | 4: **B** | 5: **C**

---
```
